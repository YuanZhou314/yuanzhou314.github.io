

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/fluid.png">
  <link rel="icon" href="/img/zz.jpg">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="小周">
  <meta name="keywords" content="">
  
    <meta name="description" content="本文出自阿里云官方文档。对网络运维稍有帮助，简单Copy记录一下">
<meta property="og:type" content="article">
<meta property="og:title" content="使用ping命令丢包或不通时的链路测试方法(阿里云)">
<meta property="og:url" content="https://zhouyinglin.top/post/92548214.html">
<meta property="og:site_name" content="小周的院子">
<meta property="og:description" content="本文出自阿里云官方文档。对网络运维稍有帮助，简单Copy记录一下">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://blog-cnd-1307088890.cos.ap-guangzhou.myqcloud.com/ping.png">
<meta property="article:published_time" content="2022-08-16T03:51:51.000Z">
<meta property="article:modified_time" content="2022-12-15T02:32:52.000Z">
<meta property="article:author" content="小周">
<meta property="article:tag" content="Linux">
<meta property="article:tag" content="运维">
<meta property="article:tag" content="网络">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="https://blog-cnd-1307088890.cos.ap-guangzhou.myqcloud.com/ping.png">
  
  
  
    <meta name="baidu-site-verification" content="code-bMcoZ9RRBp" />
  
  <title>使用ping命令丢包或不通时的链路测试方法(阿里云) - 小周的院子</title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" />



<!-- 主题依赖的图标库，不要自行修改 -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_hj8rtnfg7um.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_lbnruvf0jn.css">


<link  rel="stylesheet" href="/css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="/css/highlight.css" />
  
    <link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css" />
  



  
<link rel="stylesheet" href="https://unpkg.com/@waline/client@v2/dist/waline.css">



  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"zhouyinglin.top","root":"/","version":"1.9.2","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false,"scope":[]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"left","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"code_language":{"enable":true,"default":"TEXT"},"copy_btn":true,"image_caption":{"enable":true},"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"placement":"right","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":true,"follow_dnt":false,"baidu":null,"google":null,"gtag":null,"tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":null,"leancloud":{"app_id":"DOFm5rBfeIBUxN13vhiXlS4S-MdYXbMMI","app_key":"FJKOtk5nWqYzGoXXiFAvHIDC","path":"window.location.pathname","ignore_local":false}},"search_path":"/local-search.xml"};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
  

  

  

  

  

  

  

  
    
  



  
<!-- hexo injector head_end start -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css">

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hexo-math@4.0.0/dist/style.css">
<!-- hexo injector head_end end --><meta name="generator" content="Hexo 5.4.2"></head>


<body>
  

  <header>
    

<div class="header-inner" style="height: 70vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>小周的院子</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>
    
    <!-- 添加zyl天气 -->

<div id="tp-weather-widget"></div>
    <script>
        (function (a, h, g, f, e, d, c, b) { b = function () { d = h.createElement(g); c = h.getElementsByTagName(g)[0]; d.src = e; d.charset = "utf-8"; d.async = 1; c.parentNode.insertBefore(d, c) }; a["SeniverseWeatherWidgetObject"] = f; a[f] || (a[f] = function () { (a[f].q = a[f].q || []).push(arguments) }); a[f].l = +new Date(); if (a.attachEvent) { a.attachEvent("onload", b) } else { a.addEventListener("load", b, false) } }(window, document, "script", "SeniverseWeatherWidget", "//cdn.sencdn.com/widget2/static/js/bundle.js?t=" + parseInt((new Date().getTime() / 100000000).toString(), 10)));
        window.SeniverseWeatherWidget('show', {
            flavor: "slim",
            location: "WKJ1F428HH2F",
            geolocation: true,
            language: "zh-Hans",
            unit: "c",
            theme: "auto",
            token: "5089001e-aa9f-41c5-862d-e416aabf81f7",
            hover: "enabled",
            container: "tp-weather-widget"
        })
    </script>



    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/">
                <i class="iconfont icon-home-fill"></i>
                首页
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item dropdown">
              <a class="nav-link dropdown-toggle" target="_self" href="javascript:;" role="button"
                 data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                <i class="iconfont icon-books"></i>
                文章
              </a>
              <div class="dropdown-menu" aria-labelledby="navbarDropdown">
                
                  
                  
                  
                  <a class="dropdown-item" href="/archives/">
                    <i class="iconfont icon-archive-fill"></i>
                    归档
                  </a>
                
                  
                  
                  
                  <a class="dropdown-item" href="/categories/">
                    <i class="iconfont icon-category-fill"></i>
                    分类
                  </a>
                
                  
                  
                  
                  <a class="dropdown-item" href="/tags/">
                    <i class="iconfont icon-tags-fill"></i>
                    标签
                  </a>
                
              </div>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/boxs/">
                <i class="iconfont icon-switch-fill"></i>
                百宝箱
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/">
                <i class="iconfont icon-user-fill"></i>
                关于
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/links/">
                <i class="iconfont icon-link-fill"></i>
                友链
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" target="_blank" rel="noopener" href="https://www.foreverblog.cn/go.html">
                <i class="iconfont icon-rss"></i>
                虫洞
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              &nbsp;<i class="iconfont icon-search"></i>&nbsp;
            </a>
          </li>
          
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">&nbsp;<i
                class="iconfont icon-dark" id="color-toggle-icon"></i>&nbsp;</a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" parallax=true
     style="background: url('https://blog-cnd-1307088890.cos.ap-guangzhou.myqcloud.com/202212161220542.jpg') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle" data-typed-text="使用ping命令丢包或不通时的链路测试方法(阿里云)"></span>
          
        </div>

        
          
  <div class="mt-3">
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2022-08-16 11:51" pubdate>
          2022年8月16日 中午
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-chart"></i>
        
          9.1k 字
        
      </span>
    

    
      <span class="post-meta mr-2">
        <i class="iconfont icon-clock-fill"></i>
        
        
        
          77 分钟
        
      </span>
    

    
    
      
        <span id="leancloud-page-views-container" class="post-meta" style="display: none">
          <i class="iconfont icon-eye" aria-hidden="true"></i>
          <span id="leancloud-page-views"></span> 次
        </span>
        
      
    
  </div>


        
      </div>

      
    </div>
  </div>
</div>

</div>

  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      

    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">
            <!-- SEO header -->
            <h1 style="display: none">使用ping命令丢包或不通时的链路测试方法(阿里云)</h1>
            
            
              <div class="markdown-body">
                
                <p>本文出自阿里云官方文档。对网络运维稍有帮助，简单Copy记录一下</p>
<span id="more"></span>
<!-- categories:Dev、Ops、Study、Sth、News-->
<!-- tags: 
Python、MySQL、LeetCode、机器学习、Linux、Big Data、Java、BlockChain、Docker、Web 、分布式、
Maven、数据结构、JVM、JavaScript、Crontab、Shell、Ubuntu、VPN、NodeJS、String、VM、Hadoop、
Life、树莓派、Git、Hexo
 -->
<h3 id="概述"><a class="markdownIt-Anchor" href="#概述"></a> 概述</h3>
<p>当客户端访问目标服务器出现ping丢包或ping不通时，可以通过<code>tracert</code>或<code>mtr</code>等工具进行链路测试来判断问题根源。本文主要介绍如何通过工具进行链路测试和分析。</p>
<h3 id="详细信息"><a class="markdownIt-Anchor" href="#详细信息"></a> 详细信息</h3>
<blockquote>
<p>阿里云提醒您：</p>
<ul>
<li>如果您对实例或数据有修改、变更等风险操作，务必注意实例的容灾、容错能力，确保数据安全。</li>
<li>如果您对实例（包括但不限于ECS、RDS）等进行配置与数据修改，建议提前创建快照或开启RDS日志备份等功能。</li>
<li>如果您在阿里云平台授权或者提交过登录*、*等安全信息，建议您及时修改。</li>
</ul>
</blockquote>
<p>使用ping命令丢包或者网络不通时，可参见以下操作步骤进行链路测试并进行处理，想了解链路测试中所使用工具的更多介绍请参见更多信息。</p>
<ul>
<li>链路测试步骤</li>
<li>测试结果的简要分析</li>
<li>测试完成后的解决方法</li>
<li>常见的链路异常场景
<ul>
<li>场景一：目标主机网络配置不当</li>
<li>场景二：ICMP限速</li>
<li>场景三：环路</li>
<li>场景四：链路中断</li>
</ul>
</li>
</ul>
<h4 id="链路测试步骤"><a class="markdownIt-Anchor" href="#链路测试步骤"></a> 链路测试步骤</h4>
<p>通常情况下，链路测试步骤如下：</p>
<p><img src="https://blog-cnd-1307088890.cos.ap-guangzhou.myqcloud.com/66d1df5c-c587-4ac8-8fe2-d5237dc2c9d6.png" srcset="/img/loading.gif" lazyload alt></p>
<h5 id="步骤一获取本地网络对应的公网ip"><a class="markdownIt-Anchor" href="#步骤一获取本地网络对应的公网ip"></a> 步骤一：获取本地网络对应的公网IP</h5>
<p>在客户端本地网络内访问淘宝IP地址库，获取本地网络对应的公网IP地址。</p>
<h5 id="步骤二正向链路测试ping和mtr"><a class="markdownIt-Anchor" href="#步骤二正向链路测试ping和mtr"></a> 步骤二：正向链路测试（ping和mtr）</h5>
<p>从客户端向目标服务器做以下测试：</p>
<ul>
<li>从客户端向目标服务器域名或IP做持续的ping测试，建议至少ping 100个数据包，记录测试结果。</li>
<li>根据客户端操作系统的不同，使用WinMTR或mtr，设置测试目的地址为目标服务器域名或IP，然后进行链路测试，记录测试结果。</li>
</ul>
<h5 id="步骤三反向链路测试ping和mtr"><a class="markdownIt-Anchor" href="#步骤三反向链路测试ping和mtr"></a> 步骤三：反向链路测试（ping和mtr）</h5>
<p>进入目标服务器系统内部做以下测试：</p>
<ul>
<li>从目标服务器向步骤一获取的客户端IP做持续的ping测试，建议至少ping 100个数据包，记录测试结果。</li>
<li>根据目标服务器操作系统的不同，使用WinMTR或mtr，设置测试目的地址为客户端的IP地址，然后进行链路测试，记录测试结果。</li>
</ul>
<h5 id="步骤四测试结果分析"><a class="markdownIt-Anchor" href="#步骤四测试结果分析"></a> 步骤四：测试结果分析</h5>
<p>参见<strong>测试结果的简要分析</strong>，对测试结果进行分析。确认异常节点后，访问<a target="_blank" rel="noopener" href="https://ip.taobao.com/ipSearch?spm=a2c4g.11186623.0.0.7ac7331f36XysO">淘宝IP地址库</a>或其他可以查询IP归属地的网站，获取该异常节点的归属运营商信息。如果是客户端本地网络相关节点出现异常，则需要对本地网络进行相应排查分析。如果是运营商相关节点出现异常，则需要向运营商反馈问题。查询结果类似如下。</p>
<p><img src="https://blog-cnd-1307088890.cos.ap-guangzhou.myqcloud.com/c2de82d4-177e-4538-9a1d-b07e4024f374.png" srcset="/img/loading.gif" lazyload alt></p>
<h4 id="测试结果的简要分析"><a class="markdownIt-Anchor" href="#测试结果的简要分析"></a> 测试结果的简要分析</h4>
<p>由于mtr（WinMTR）有更高的准确性，本文以其测试结果为例，参见以下要点进行分析。此处分析时以如下示例图为基础。</p>
<p><img src="https://blog-cnd-1307088890.cos.ap-guangzhou.myqcloud.com/17fc8b0c-276e-4373-87eb-814342c16edf.png" srcset="/img/loading.gif" lazyload alt></p>
<h5 id="要点一网络区域"><a class="markdownIt-Anchor" href="#要点一网络区域"></a> 要点一：网络区域</h5>
<p>正常情况下，从客户端到目标服务器的整个链路中会包含以下网络区域：</p>
<blockquote>
<p><strong>说明</strong>：您可以通过<a target="_blank" rel="noopener" href="https://ip.taobao.com/ipSearch">IP地址库</a>确认IP地址所属网络情况。</p>
</blockquote>
<ul>
<li>客户端本地网络：即本地局域网和本地网络提供商网络。如上图中的区域A。如果该区域出现异常，并且是客户端本地网络中的节点出现异常，则需要对本地网络进行相应的排查分析。如果是本地网络提供商网络出现异常，则需要向当地运营商反馈问题。</li>
<li>运营商网络：如上图中的区域B。如果该区域出现异常，可以根据异常节点的IP查询其所属的运营商，直接向对应运营商进行反馈。</li>
<li>目标服务器本地网络：即目标服务器所属提供商的网络。如上图中的区域C。如果该区域出现异常，需要向目标服务器所属的网络运营商反馈问题。</li>
</ul>
<h5 id="要点二链路负载均衡"><a class="markdownIt-Anchor" href="#要点二链路负载均衡"></a> 要点二：链路负载均衡</h5>
<p>如上图中的区域D。如果中间链路某些部分启用了链路负载均衡，则mtr只会对首尾节点进行编号和探测统计。中间节点只会显示相应的IP或域名信息。</p>
<h5 id="要点三结合avg平均值和stdev标准偏差综合判断"><a class="markdownIt-Anchor" href="#要点三结合avg平均值和stdev标准偏差综合判断"></a> 要点三：结合Avg（平均值）和StDev（标准偏差）综合判断</h5>
<p>由于链路抖动或其它因素的影响，节点的Best和Worst值可能相差很大。Avg统计了自链路测试以来所有探测的平均值，所以能更好的反应出相应节点的网络质量。而StDev越高，则说明数据包在相应节点的延时值越不相同，即越离散。所以标准偏差值可用于协助判断Avg是否真实反应了相应节点的网络质量。例如，如果标准偏差很大，说明数据包的延迟是不确定的。可能某些数据包延迟很小，例如25ms，而另一些延迟却很大，例如350ms，但最终得到的平均延迟反而可能是正常的。所以，此时Avg并不能很好的反应出实际的网络质量情况。</p>
<p>综上所属，建议的分析标准如下：</p>
<ul>
<li>
<p>如果StDev很高，则同步观察相应节点的Best和Worst，来判断相应节点是否存在异常。</p>
</li>
<li>
<p>如果StDev不高，则通过Avg来判断相应节点是否存在异常。</p>
<blockquote>
<p>**注意：**上述StDev高或者不高，并没有具体的时间范围标准。而需要根据同一节点其它列的延迟值大小来进行相对评估。比如，如果Avg为30ms，那么，当StDev为25ms，则认为是很高的偏差。而如果Avg为325ms，StDev为25ms，反而认为是不高的偏差。</p>
</blockquote>
</li>
</ul>
<h5 id="要点四loss丢包率的判断"><a class="markdownIt-Anchor" href="#要点四loss丢包率的判断"></a> 要点四：Loss%（丢包率）的判断</h5>
<p>任一节点的Loss%（丢包率）如果不为零，则说明这一跳网络可能存在问题。导致相应节点丢包的原因通常有以下两种：</p>
<ul>
<li>运营商基于安全或性能需求，限制了节点的ICMP发送速率，导致丢包。</li>
<li>节点确实存在异常，导致丢包。</li>
</ul>
<p>结合异常节点及其后续节点的丢包情况，并参见以下内容，判定丢包原因。</p>
<ul>
<li>如果随后节点均没有丢包，则通常表示异常节点丢包是由于运营商策略限制所致。可以忽略相关丢包。如上图中的第2跳所示。</li>
<li>如果随后节点也出现丢包，则通常说明异常节点确实存在网络异常，导致丢包。如上图中的第5跳所示。</li>
</ul>
<p>另外，上述两种情况可能同时发生，即相应节点既存在策略限速，又存在网络异常。对于这种情况，如果异常节点及其后续节点连续出现丢包，而且各节点的丢包率不同，则通常以最后几跳的丢包率为准。如上图所示，在第 5、6、7跳均出现了丢包。所以，最终丢包情况，以第7跳的40%作为参考。</p>
<h5 id="要点五关于延迟"><a class="markdownIt-Anchor" href="#要点五关于延迟"></a> 要点五：关于延迟</h5>
<p>关于延迟，有以下两种场景：</p>
<ul>
<li>场景一：延迟跳变</li>
</ul>
<p>如果在某一跳之后延迟明显陡增，则通常判断该节点存在网络异常。如上图所示，从第5跳之后的后续节点延迟明显陡增，则推断是第5跳节点出现了网络异常。不过，高延迟并不一定完全意味着相应节点存在异常。如上图所示，第5跳之后，虽然后续节点延迟明显陡增，但测试数据最终仍然正常到达了目的主机。所以，延迟大也有可能是在数据回包链路中引发的。所以，需要结合反向链路测试一并分析。</p>
<ul>
<li>场景二：ICMP限速导致延迟增加</li>
</ul>
<p>ICMP策略限速也可能会导致相应节点的延迟陡增，但后续节点通常会恢复正常。如上图所示，第3跳有100%的丢包率，同时延迟也明显陡增。但随后节点的延迟马上恢复了正常。所以判断该节点的延迟陡增及丢包是由于策略限速所致。</p>
<h4 id="测试完成后的解决方法"><a class="markdownIt-Anchor" href="#测试完成后的解决方法"></a> 测试完成后的解决方法</h4>
<ul>
<li>当出现ping丢包或ping不通时，首先请参考<a target="_blank" rel="noopener" href="https://help.aliyun.com/document_detail/73607.htm">云服务器ECS网络故障诊断</a>，排查是否为网络故障。</li>
<li>如果确认是因系统中病毒导致使用ping命令测试ECS实例的IP地址间歇性丢包，则可参考<a target="_blank" rel="noopener" href="https://help.aliyun.com/document_detail/73247.htm">使用ping命令测试ECS实例的IP地址间歇性丢包</a>进行处理。</li>
<li>如果是因删除ECS实例的默认安全组规则导致无法ping通ECS实例，可参考<a target="_blank" rel="noopener" href="https://help.aliyun.com/document_detail/40596.htm">删除ECS实例的默认安全组规则导致无法ping通ECS实例</a>进行处理。</li>
<li>如果在Linux系统内核没有禁PING的情况下，是因系统内部防火墙策略设置导致ECS服务器PING不通。可参考<a target="_blank" rel="noopener" href="https://help.aliyun.com/document_detail/41332.htm">Linux系统的ECS中没有禁PING却PING不通的解决方法</a>。</li>
</ul>
<h4 id="常见的链路异常场景"><a class="markdownIt-Anchor" href="#常见的链路异常场景"></a> 常见的链路异常场景</h4>
<p>常见的链路异常场景及测试报告如下：</p>
<h5 id="场景一目标主机网络配置不当"><a class="markdownIt-Anchor" href="#场景一目标主机网络配置不当"></a> 场景一：目标主机网络配置不当</h5>
<p>示例数据如下。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs bash">[root@mycentos6 ~]<span class="hljs-comment"># mtr --no-dns www.google.com</span><br>My traceroute  [v0.75]<br>mycentos6.6 (0.0.0.0)                         Wed Jun 15 19:06:29 2016<br>Keys:  Help   Display mode                    Packets               Ping*r&gt;Host                                        Loss%   Snt   Last   Avg  Best  Wrst StDev <br>1. ???<br>2. ???<br>3. 1XX.X.X.X                              0.0%     10  521.3  90.1   2.7 521.3 211.3<br>4. 11X.X.X.X                              0.0%     10    2.9   4.7   1.6  10.6   3.9<br>5. 2X.X.X.X                               80.0%    10    3.0   3.0   3.0   3.0   0.0<br>6. 2X.XX.XX.XX                            0.0%     10    1.7   7.2   1.6  34.9  13.6<br>7. 1XX.1XX.XX.X                             0.0%     10    5.2   5.2   5.1   5.2   0.0<br>8. 2XX.XX.XX.XX                             0.0%     10    5.3   5.2   5.1   5.3   0.1<br>9. 173.194.200.105                          100.0%   10    0.0   0.0   0.0   0.0   0.0<br></code></pre></td></tr></table></figure>
<p>在该示例中，数据包在目标地址出现了100%的丢包。从数据上看是数据包没有到达，其实很有可能是目标服务器相关安全策略（比如防火墙、iptables 等）禁用了ICMP所致，导致目的主机无法发送任何应答。所以，该场景需要排查目标服务器的安全策略配置。</p>
<h5 id="场景二icmp限速"><a class="markdownIt-Anchor" href="#场景二icmp限速"></a> 场景二：ICMP限速</h5>
<p>示例数据如下。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs bash">[root@mycentos6 ~]<span class="hljs-comment"># mtr --no-dns www.google.com</span><br>My traceroute  [v0.75]<br>mycentos6.6 (0.0.0.0)                         Wed Jun 15 19:06:29 2016<br>Keys:  Help   Display mode                    Packets               Ping*r&gt;Host                                        Loss%   Snt   Last   Avg  Best  Wrst StDev <br>1. 63.247.X.X               			 0.0%    10    0.3   0.6   0.3   1.2   0.3<br>2. 63.247.X.XX                 		 0.0%    10    0.4   1.0   0.4   6.1   1.8<br>3. 209.51.130.213              		 0.0%    10    0.8   2.7   0.8  19.0   5.7<br>4. aix.pr1.atl.google.com        	        0.0%    10    6.7   6.8   6.7   6.9   0.1<br>5. 72.14.233.56                 		 60.0%    10   27.2  25.3  23.1  26.4   2.9<br>6. 209.85.254.247                		 0.0%    10   39.1  39.4  39.1  39.7   0.2<br>7. 64.233.174.46                 		 0.0%    10   39.6  40.4  39.4  46.9   2.3<br>8. gw-in-f147.1e100.net          		 0.0%    10   39.6  40.5  39.5  46.7   2.2<br></code></pre></td></tr></table></figure>
<p>在该示例中，在第5跳出现了明显的丢包，但后续节点均未见异常。所以推断是该节点ICMP限速所致。该场景对最终客户端到目标服务器的数据传输不会有影响，所以，分析的时候可以忽略。</p>
<h5 id="场景三环路"><a class="markdownIt-Anchor" href="#场景三环路"></a> 场景三：环路</h5>
<p>示例数据如下。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs bash">[root@mycentos6 ~]<span class="hljs-comment"># mtr --no-dns www.google.com</span><br>My traceroute  [v0.75]<br>mycentos6.6 (0.0.0.0)                         Wed Jun 15 19:06:29 2016<br>Keys:  Help   Display mode                    Packets               Ping*r&gt;Host                                        Loss%   Snt   Last   Avg  Best  Wrst StDev <br>1. 63.247.7X.X                  		 0.0%    10    0.3   0.6   0.3   1.2   0.3<br>2. 63.247.6X.X                 		 0.0%    10    0.4   1.0   0.4   6.1   1.8<br>3. 209.51.130.213                		 0.0%    10    0.8   2.7   0.8  19.0   5.7<br>4. aix.pr1.atl.google.com        		 0.0%    10    6.7   6.8   6.7   6.9   0.1<br>5. 72.14.233.56                  		 0.0%    10    0.0   0.0   0.0   0.0   0.0<br>6. 72.14.233.57                  		 0.0%    10    0.0   0.0   0.0   0.0   0.0<br>7. 72.14.233.56                  		 0.0%    10    0.0   0.0   0.0   0.0   0.0<br>8. 72.14.233.57                  		 0.0%    10    0.0   0.0   0.0   0.0   0.0<br>9 ???                            		 0.0%    10    0.0   0.0   0.0   0.0   0.0<br></code></pre></td></tr></table></figure>
<p>在该示例中，数据包在第5跳之后出现了循环跳转，导致最终无法到达目标服务器。这通常是由于运营商相关节点路由配置异常所致。所以，该场景需要联系相应节点归属运营商处理。</p>
<h5 id="场景四链路中断"><a class="markdownIt-Anchor" href="#场景四链路中断"></a> 场景四：链路中断</h5>
<p>示例数据如下。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs bash">[root@mycentos6 ~]<span class="hljs-comment"># mtr --no-dns www.google.com</span><br>My traceroute  [v0.75]<br>mycentos6.6 (0.0.0.0)                         Wed Jun 15 19:06:29 2016<br>Keys:  Help   Display mode                    Packets               Ping*r&gt;Host                                        Loss%   Snt   Last   Avg  Best  Wrst StDev <br>1. 63.247.7X.X                  		 0.0%    10    0.3   0.6   0.3   1.2   0.3<br>2. 63.247.6X.X                 		 0.0%    10    0.4   1.0   0.4   6.1   1.8<br>3. 209.51.130.213                		 0.0%    10    0.8   2.7   0.8  19.0   5.7<br>4. aix.pr1.atl.google.com        		 0.0%    10    6.7   6.8   6.7   6.9   0.1<br>5. ???                           		 0.0%    10    0.0   0.0   0.0   0.0   0.0<br>6. ???                           		 0.0%    10    0.0   0.0   0.0   0.0   0.0<br>7. ???                           		 0.0%    10    0.0   0.0   0.0   0.0   0.0<br>8. ???                           		 0.0%    10    0.0   0.0   0.0   0.0   0.0<br>9 ???                            		 0.0%    10    0.0   0.0   0.0   0.0   0.0<br></code></pre></td></tr></table></figure>
<p>在该示例中，数据包在第4跳之后就无法收到任何反馈。这通常是由于相应节点中断所致。建议结合反向链路测试做进一步确认。该场景需要联系相应节点归属运营商处理。</p>
<h3 id="更多信息"><a class="markdownIt-Anchor" href="#更多信息"></a> 更多信息</h3>
<p>操作系统类型不同，链路测试所使用的工具也有所不同，简要介绍如下：</p>
<h4 id="linux系统"><a class="markdownIt-Anchor" href="#linux系统"></a> Linux系统</h4>
<p>此处简单介绍两个链路测试工具：</p>
<h5 id="工具一mtr命令"><a class="markdownIt-Anchor" href="#工具一mtr命令"></a> 工具一：mtr命令</h5>
<p>mtr（My traceroute）几乎是所有Linux发行版本预装的网络测试工具。其将<code>ping</code>和<code>traceroute</code>的功能合并，所以功能更强大。mtr默认发送ICMP数据包进行链路探测。您也可以通过<code>-u</code>参数来指定使用UDP数据包进行探测。相对于<code>traceroute</code>只会做一次链路跟踪测试，mtr会对链路上的相关节点做持续探测并给出相应的统计信息。所以，mtr能避免节点波动对测试结果的影响，所以其测试结果更正确，建议优先使用。</p>
<p><strong>用法说明</strong></p>
<figure class="highlight brainfuck"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs brainfuck"><span class="hljs-comment">mtr</span> <span class="hljs-title">[</span><span class="hljs-literal">-</span><span class="hljs-comment">BfhvrwctglxspQomniuT46</span><span class="hljs-title">]</span> <span class="hljs-title">[</span><span class="hljs-literal">--</span><span class="hljs-comment">help</span><span class="hljs-title">]</span> <span class="hljs-title">[</span><span class="hljs-literal">--</span><span class="hljs-comment">version</span><span class="hljs-title">]</span> <span class="hljs-title">[</span><span class="hljs-literal">--</span><span class="hljs-comment">report</span><span class="hljs-title">]</span><br>                <span class="hljs-title">[</span><span class="hljs-literal">--</span><span class="hljs-comment">report</span><span class="hljs-literal">-</span><span class="hljs-comment">wide</span><span class="hljs-title">]</span> <span class="hljs-title">[</span><span class="hljs-literal">--</span><span class="hljs-comment">report</span><span class="hljs-literal">-</span><span class="hljs-comment">cycles=COUNT</span><span class="hljs-title">]</span> <span class="hljs-title">[</span><span class="hljs-literal">--</span><span class="hljs-comment">curses</span><span class="hljs-title">]</span> <span class="hljs-title">[</span><span class="hljs-literal">--</span><span class="hljs-comment">gtk</span><span class="hljs-title">]</span><br>                <span class="hljs-title">[</span><span class="hljs-literal">--</span><span class="hljs-comment">csv|</span><span class="hljs-literal">-</span><span class="hljs-comment">C</span><span class="hljs-title">]</span> <span class="hljs-title">[</span><span class="hljs-literal">--</span><span class="hljs-comment">raw</span><span class="hljs-title">]</span> <span class="hljs-title">[</span><span class="hljs-literal">--</span><span class="hljs-comment">xml</span><span class="hljs-title">]</span> <span class="hljs-title">[</span><span class="hljs-literal">--</span><span class="hljs-comment">split</span><span class="hljs-title">]</span> <span class="hljs-title">[</span><span class="hljs-literal">--</span><span class="hljs-comment">mpls</span><span class="hljs-title">]</span> <span class="hljs-title">[</span><span class="hljs-literal">--</span><span class="hljs-comment">no</span><span class="hljs-literal">-</span><span class="hljs-comment">dns</span><span class="hljs-title">]</span> <span class="hljs-title">[</span><span class="hljs-literal">--</span><span class="hljs-comment">show</span><span class="hljs-literal">-</span><span class="hljs-comment">ip*r</span>&gt;                <span class="hljs-title">[</span><span class="hljs-literal">--</span><span class="hljs-comment">address interface</span><span class="hljs-title">]</span> <span class="hljs-title">[</span><span class="hljs-literal">--</span><span class="hljs-comment">filename=FILE|</span><span class="hljs-literal">-</span><span class="hljs-comment">F</span><span class="hljs-title">]</span><br>                <span class="hljs-title">[</span><span class="hljs-literal">--</span><span class="hljs-comment">ipinfo=item_no|</span><span class="hljs-literal">-</span><span class="hljs-comment">y item_no</span><span class="hljs-title">]</span><br>                <span class="hljs-title">[</span><span class="hljs-literal">--</span><span class="hljs-comment">aslookup|</span><span class="hljs-literal">-</span><span class="hljs-comment">z</span><span class="hljs-title">]</span><br>                <span class="hljs-title">[</span><span class="hljs-literal">--</span><span class="hljs-comment">psize=bytes/</span><span class="hljs-literal">-</span><span class="hljs-comment">*ytes</span><span class="hljs-title">]</span> <span class="hljs-title">[</span><span class="hljs-literal">--</span><span class="hljs-comment">order field*r</span>&gt;                <span class="hljs-title">[</span><span class="hljs-literal">--</span><span class="hljs-comment">report</span><span class="hljs-literal">-</span><span class="hljs-comment">wide|</span><span class="hljs-literal">-</span><span class="hljs-comment">w</span><span class="hljs-title">]</span> <span class="hljs-title">[</span><span class="hljs-literal">--</span><span class="hljs-comment">inet</span><span class="hljs-title">]</span> <span class="hljs-title">[</span><span class="hljs-literal">--</span><span class="hljs-comment">inet6</span><span class="hljs-title">]</span> <span class="hljs-title">[</span><span class="hljs-literal">--</span><span class="hljs-comment">max</span><span class="hljs-literal">-</span><span class="hljs-comment">ttl=NUM</span><span class="hljs-title">]</span> <span class="hljs-title">[</span><span class="hljs-literal">--</span><span class="hljs-comment">first</span><span class="hljs-literal">-</span><span class="hljs-comment">ttl=NUM</span><span class="hljs-title">]</span><br>                <span class="hljs-title">[</span><span class="hljs-literal">--</span><span class="hljs-comment">bitpattern=NUM</span><span class="hljs-title">]</span> <span class="hljs-title">[</span><span class="hljs-literal">--</span><span class="hljs-comment">tos=NUM</span><span class="hljs-title">]</span> <span class="hljs-title">[</span><span class="hljs-literal">--</span><span class="hljs-comment">udp</span><span class="hljs-title">]</span> <span class="hljs-title">[</span><span class="hljs-literal">--</span><span class="hljs-comment">tcp</span><span class="hljs-title">]</span> <span class="hljs-title">[</span><span class="hljs-literal">--</span><span class="hljs-comment">port=PORT</span><span class="hljs-title">]</span> <span class="hljs-title">[</span><span class="hljs-literal">--</span><span class="hljs-comment">timeout=SECONDS</span><span class="hljs-title">]</span><br>                <span class="hljs-title">[</span><span class="hljs-literal">--</span><span class="hljs-comment">interval=SECONDS</span><span class="hljs-title">]</span> <span class="hljs-comment">HOSTNAME</span><br></code></pre></td></tr></table></figure>
<p><strong>常见可选参数说明</strong></p>
<ul>
<li>–report：以报告模式显示输出。</li>
<li>–split：将每次追踪的结果分别列出来，而非统计整个结果。</li>
<li>–psize：指定ping数据包的大小。</li>
<li>–no-dns：不对IP地址做域名反解析。</li>
<li>–address：主机有多个IP地址时，设置发送数据包的IP地址。</li>
<li>-4：只使用IPv4协议。</li>
<li>-6：只使用IPv6协议。</li>
</ul>
<p>另外，也可以在mtr运行过程中，输入类似如下的字母用于快速切换模式。</p>
<ul>
<li>？或h：显示帮助菜单。</li>
<li>d：切换显示模式。</li>
<li>n：启用或禁用DNS域名解析。</li>
<li>u：切换使用ICMP或UDP数据包进行探测。</li>
</ul>
<p><strong>命令输出示例</strong><br>
<img src="https://blog-cnd-1307088890.cos.ap-guangzhou.myqcloud.com/5aa45796-7859-416d-97cb-42c41d5e6b49.png" srcset="/img/loading.gif" lazyload alt></p>
<p><strong>返回结果说明</strong></p>
<p>默认配置下，返回结果中各数据列的说明如下：</p>
<ul>
<li>第一列（Host）：节点IP地址和域名。按<strong>n</strong>键可切换显示。</li>
<li>第二列（Loss%）：节点丢包率。</li>
<li>第三列（Snt）：每秒发送数据包数。默认值是10，可以通过<code>-c</code>参数指定。</li>
<li>第四列（Last）：最近一次的探测延迟。</li>
<li>第五、六、七列（Avg、Best、Worst）：分别是探测延迟的平均值、最小值和最大值。</li>
<li>第八列（StDev）：标准偏差，越大说明相应节点越不稳定。</li>
</ul>
<h5 id="工具二traceroute命令"><a class="markdownIt-Anchor" href="#工具二traceroute命令"></a> 工具二：traceroute命令</h5>
<p>traceroute也是几乎所有Linux发行版本预装的网络测试工具，用于跟踪Internet协议（IP）数据包传送到目标地址时经过的路径。</p>
<ol>
<li>
<p>首先，traceroute先发送小的具有最大存活时间值（Max_TTL）的UDP探测数据包。</p>
</li>
<li>
<p>然后，侦听从网关开始的整个链路上的ICMP TIME_EXCEEDED响应。探测从TTL=1开始，TTL值逐步增加，直至接收到ICMP PORT_UNREACHABLE消息。</p>
<blockquote>
<p>说明</p>
<p>：</p>
<ul>
<li>ICMP PORT_UNREACHABLE消息用于标识目标主机已经被定位，或命令已经达到允许跟踪的最大TTL值。</li>
<li>traceroute默认发送UDP数据包进行链路探测，可以通过<code>-I</code>参数来指定使用ICMP数据包进行探测。</li>
</ul>
</blockquote>
</li>
</ol>
<p><strong>用法说明</strong></p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs css">traceroute <span class="hljs-selector-attr">[-I]</span> <span class="hljs-selector-attr">[ -m Max_ttl ]</span> <span class="hljs-selector-attr">[ -n ]</span> <span class="hljs-selector-attr">[ -p Port ]</span> <span class="hljs-selector-attr">[ -q Nqueries ]</span> <span class="hljs-selector-attr">[ -r ]</span> <span class="hljs-selector-attr">[ -s SRC_Addr ]</span> <span class="hljs-selector-attr">[ -t TypeOfService ]</span> <span class="hljs-selector-attr">[ -f flow ]</span> <span class="hljs-selector-attr">[ -v ]</span> <span class="hljs-selector-attr">[ -w WaitTime ]</span> Host <span class="hljs-selector-attr">[ PacketSize ]</span><br></code></pre></td></tr></table></figure>
<p><strong>常见可选参数说明</strong></p>
<ul>
<li>-d：使用Socket层级的排错功能。</li>
<li>-f：设置第一个检测数据包的存活数值TTL的大小。</li>
<li>-F：设置不要分段标识。</li>
<li>-g：设置来源路由网关，最多可设置8个。</li>
<li>-i：主机有多个网卡时，使用指定的网卡发送数据包。</li>
<li>-I：使用ICMP数据包替代UDP数据包进行探测。</li>
<li>-m：设置检测数据包的最大存活数值TTL的大小。</li>
<li>-n：直接使用IP地址而非主机名称（禁用DNS反查）。</li>
<li>-p：设置UDP传输协议的通信端口。</li>
<li>-r：忽略普通的Routing Table，直接将数据包发送到目标主机上。</li>
<li>-s：设置本地主机发送数据包的IP地址。</li>
<li>-t：设置检测数据包的TOS数值。</li>
<li>-v：详细显示指令的执行过程。</li>
<li>-w：设置等待远端主机回包时间。</li>
<li>-x：开启或关闭数据包的正确性检验。</li>
</ul>
<p><strong>命令输出示例</strong></p>
<p><img src="https://blog-cnd-1307088890.cos.ap-guangzhou.myqcloud.com/308dfc1d-cb8c-4dd9-9dc7-01b4ad9374a5.png" srcset="/img/loading.gif" lazyload alt></p>
<p><img src="https://blog-cnd-1307088890.cos.ap-guangzhou.myqcloud.com/308dfc1d-cb8c-4dd9-9dc7-01b4ad9374a5.png" srcset="/img/loading.gif" lazyload alt></p>
<p>traceroute工具的更多用法请参见<a target="_blank" rel="noopener" href="http://linux.die.net/man/8/traceroute">traceroute工具的man帮助</a>。</p>
<h4 id="windows系统"><a class="markdownIt-Anchor" href="#windows系统"></a> Windows系统</h4>
<p>此处简单介绍两个链路测试工具：</p>
<h5 id="工具一winmtr建议优先使用"><a class="markdownIt-Anchor" href="#工具一winmtr建议优先使用"></a> 工具一：WinMTR（建议优先使用）</h5>
<p>WinMTR是mtr工具在Windows环境下的图形化实现，但进行了功能简化，只支持部分mtr的参数。WinMTR默认发送ICMP数据包进行探测，无法切换，和mtr一样。相比tracert，WinMTR能避免节点波动对测试结果的影响，所以测试结果更正确。所以在WinMTR可用的情况下，建议优先使用WinMTR进行链路测试。</p>
<p><strong>用法说明</strong></p>
<p>WinMTR无需安装，直接解压运行即可。操作方法非常简单，说明如下：</p>
<ol>
<li>如下图所示，运行程序后，在<strong>Host</strong>字段输入目标服务器域名或IP，注意不要包含空格。<br>
<img src="https://blog-cnd-1307088890.cos.ap-guangzhou.myqcloud.com/81e3ded2-3ff8-461f-aa66-049733f28bbe.png" srcset="/img/loading.gif" lazyload alt></li>
<li>单击<strong>Start</strong>开始测试。开始测试后，相应按钮变成了<strong>Stop</strong>。</li>
<li>运行一段时间后，单击<strong>Stop</strong>停止测试。</li>
<li>其它选项说明如下。
<ul>
<li>Copy Text to clipboard：将测试结果以文本格式复制到粘贴板。</li>
<li>Copy HTML to clipboard：将测试结果以HTML格式复制到粘贴板。</li>
<li>Export TEXT：将测试结果以文本格式导出到指定文件。</li>
<li>Export HTML：将测试结果以HTML格式导出到指定文件。</li>
<li>Options：可选参数，包括的可选参数如下。
<ul>
<li>Interval（sec）：每次探测的间隔（过期）时间。默认为1秒。</li>
<li>ping size(bytes)：ping探测所使用的数据包大小，默认为64字节。</li>
<li>Max hosts in LRU list：LRU列表支持的最大主机数，默认值为128。</li>
<li>Resolve names：通过反查IP地址，以域名显示相关节点。</li>
</ul>
</li>
</ul>
</li>
</ol>
<p><strong>返回结果说明</strong></p>
<p>默认配置下，返回结果中各数据列的说明如下：</p>
<ul>
<li>第一列（Hostname）：节点的IP或域名。</li>
<li>第二列（Nr）：节点编号。</li>
<li>第三列（Loss%）：节点丢包率。</li>
<li>第四列（Sent）：已发送的数据包数量。</li>
<li>第五列（Recv）：已成功接收的数据包数量。</li>
<li>第六、七、八、九列（Best 、Avg、Worst、Last）：分别是到相应节点延迟的最小值、平均值、最大值和最后一次值。</li>
</ul>
<h5 id="工具二tracert命令行工具"><a class="markdownIt-Anchor" href="#工具二tracert命令行工具"></a> 工具二：tracert命令行工具</h5>
<p>tracert（Trace Route）是Windows自带的网络诊断命令行程序，用于跟踪Internet协议（IP）数据包传送到目标地址时经过的路径。 tracert通过向目标地址发送ICMP数据包来确定到目标地址的路由。在这些数据包中，tracert使用了不同的IP生存期，即TTL值。由于要求沿途的路由器在转发数据包前必须至少将TTL减少1，因此TTL实际上相当于一个跃点计数器（hop counter）。当某个数据包的TTL达到0时，相应节点就会向源计算机发送一个ICMP超时的消息。</p>
<p>tracert第一次发送TTL为1的数据包，并在每次后续传输时将TTL增加1，直到目标地址响应或达到TTL的最大值。中间路由器发送回来的ICMP超时消息中包含了相应节点的信息。</p>
<p><strong>用法说明</strong></p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs css">tracert <span class="hljs-selector-attr">[-d]</span> <span class="hljs-selector-attr">[-h maximum_hops]</span> <span class="hljs-selector-attr">[-j host-list]</span> <span class="hljs-selector-attr">[-w timeout]</span> <span class="hljs-selector-attr">[-R]</span> <span class="hljs-selector-attr">[-S srcaddr]</span> <span class="hljs-selector-attr">[-4]</span> <span class="hljs-selector-attr">[-6]</span> target_name<br></code></pre></td></tr></table></figure>
<p><strong>常见可选参数说明</strong></p>
<ul>
<li>-d：不要将地址解析为主机名（禁用DNS反解）。</li>
<li>-h：maximum_hops，指定搜索目标地址时的最大跃点数。</li>
<li>-j： host-list，指定沿主机列表的松散源路由。</li>
<li>-w：timeout，等待每个回复的超时时间（以毫秒为单位）。</li>
<li>-R：跟踪往返行程路径（仅适用于IPv6）。</li>
<li>-S：srcaddr，要使用的源地址（仅适用于IPv6）。</li>
<li>-4：强制使用IPv4。</li>
<li>-6：强制使用IPv6。</li>
<li>target_host：目标主机域名或IP地址。</li>
</ul>
<p><strong>命令输出示例</strong></p>
<figure class="highlight crmsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs crmsh">C:\&gt; tracert -d <span class="hljs-number">223.5</span>.<span class="hljs-number">5.5</span><br>通过最多 <span class="hljs-number">30</span> 个跃点跟踪到 <span class="hljs-number">223.5</span>.<span class="hljs-number">5.5</span> 的路由<br><span class="hljs-number">1</span>                          请求超时。<br><span class="hljs-number">2</span>     <span class="hljs-number">9</span> <span class="hljs-keyword">ms</span>     <span class="hljs-title">3</span> <span class="hljs-keyword">ms</span>    <span class="hljs-title">12</span> <span class="hljs-keyword">ms</span>  <span class="hljs-title">192</span>.<span class="hljs-number">168</span>.X.X<br><span class="hljs-number">3</span>     <span class="hljs-number">4</span> <span class="hljs-keyword">ms</span>     <span class="hljs-title">9</span> <span class="hljs-keyword">ms</span>     <span class="hljs-title">2</span> <span class="hljs-keyword">ms</span>  <span class="hljs-title">X</span>.X.X.X<br><span class="hljs-number">4</span>     <span class="hljs-number">9</span> <span class="hljs-keyword">ms</span>     <span class="hljs-title">2</span> <span class="hljs-keyword">ms</span>     <span class="hljs-title">1</span> <span class="hljs-keyword">ms</span>  <span class="hljs-title">XX</span>.XX.XX.XX<br><span class="hljs-number">5</span>    <span class="hljs-number">11</span> <span class="hljs-keyword">ms</span>                  <span class="hljs-title">211</span>.XX.X.XX<br><span class="hljs-number">6</span>     <span class="hljs-number">3</span> <span class="hljs-keyword">ms</span>     <span class="hljs-title">2</span> <span class="hljs-keyword">ms</span>     <span class="hljs-title">2</span> <span class="hljs-keyword">ms</span>  <span class="hljs-title">2XX</span>.XX.<span class="hljs-number">1</span>XX.XX<br><span class="hljs-number">7</span>     <span class="hljs-number">2</span> <span class="hljs-keyword">ms</span>     <span class="hljs-title">2</span> <span class="hljs-keyword">ms</span>     <span class="hljs-title">1</span> <span class="hljs-keyword">ms</span>  <span class="hljs-title">42</span>.XX.<span class="hljs-number">2</span>XX.<span class="hljs-number">1</span>XX<br><span class="hljs-number">8</span>    <span class="hljs-number">32</span> <span class="hljs-keyword">ms</span>     <span class="hljs-title">4</span> <span class="hljs-keyword">ms</span>     <span class="hljs-title">3</span> <span class="hljs-keyword">ms</span>  <span class="hljs-title">42</span>.XX.<span class="hljs-number">2</span>XX.<span class="hljs-number">2</span>XX<br><span class="hljs-number">9</span>                          请求超时。<br><span class="hljs-number">10</span>     <span class="hljs-number">3</span> <span class="hljs-keyword">ms</span>     <span class="hljs-title">2</span> <span class="hljs-keyword">ms</span>     <span class="hljs-title">2</span> <span class="hljs-keyword">ms</span>  <span class="hljs-title">223</span>.<span class="hljs-number">5.5</span>.<span class="hljs-number">5</span><br>跟踪完成。<br></code></pre></td></tr></table></figure>
<p>转载自知乎<br>
原文：<a target="_blank" rel="noopener" href="https://help.aliyun.com/document_detail/40573.html#noPMw">https://help.aliyun.com/document_detail/40573.html#noPMw</a><br>
如有更新，以来源站点为主。</p>

                
              </div>
            
            <hr/>
            <div>
              <div class="post-metas my-3">
  
    <div class="post-meta mr-3 d-flex align-items-center">
      <i class="iconfont icon-category"></i>
      

<span class="category-chains">
  
  
    
      <span class="category-chain">
        
  <a href="/categories/Ops/" class="category-chain-item">Ops</a>
  
  

      </span>
    
  
</span>

    </div>
  
  
    <div class="post-meta">
      <i class="iconfont icon-tags"></i>
      
        <a href="/tags/Linux/">#Linux</a>
      
        <a href="/tags/%E8%BF%90%E7%BB%B4/">#运维</a>
      
        <a href="/tags/%E7%BD%91%E7%BB%9C/">#网络</a>
      
    </div>
  
</div>


              
  

  <div class="license-box my-3">
    <div class="license-title">
      <div>使用ping命令丢包或不通时的链路测试方法(阿里云)</div>
      <div>https://zhouyinglin.top/post/92548214.html</div>
    </div>
    <div class="license-meta">
      
        <div class="license-meta-item">
          <div>作者</div>
          <div>小周</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>发布于</div>
          <div>2022年8月16日</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>更新于</div>
          <div>2022年12月15日</div>
        </div>
      
      <div class="license-meta-item">
        <div>许可协议</div>
        <div>
          
            
            
              <a target="_blank" href="https://creativecommons.org/licenses/by-sa/4.0/">
              <span class="hint--top hint--rounded" aria-label="BY - 署名">
                <i class="iconfont icon-by"></i>
              </span>
              </a>
            
              <a target="_blank" href="https://creativecommons.org/licenses/by-sa/4.0/">
              <span class="hint--top hint--rounded" aria-label="SA - 相同方式共享">
                <i class="iconfont icon-sa"></i>
              </span>
              </a>
            
          
        </div>
      </div>
    </div>
    <div class="license-icon iconfont"></div>
  </div>



              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/post/bc5d8ac6.html" title="算法的时间与空间复杂度">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">算法的时间与空间复杂度</span>
                        <span class="visible-mobile">上一篇</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/post/84c67fbf.html" title="Hexo-配置腾讯云对象存储COS作为图床">
                        <span class="hidden-mobile">Hexo-配置腾讯云对象存储COS作为图床</span>
                        <span class="visible-mobile">下一篇</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
  <article id="comments" lazyload>
    
  <div id="waline"></div>
  <script type="text/javascript">
    Fluid.utils.loadComments('#waline', function() {
      Fluid.utils.createCssLink('https://lib.baomitu.com/waline/2.5.1/waline.min.css')
      Fluid.utils.createScript('https://lib.baomitu.com/waline/2.5.1/waline.min.js', function() {
        var options = Object.assign(
          {"serverURL":"https://waline-comment-blond.vercel.app/","path":"window.location.pathname","meta":["nick","mail","link"],"login":"enable","lang":"zh-CN","emoji":["https://unpkg.com/@waline/emojis@1.0.1/tieba","https://unpkg.com/@waline/emojis@1.0.1/bilibili"],"dark":"html[data-user-color-scheme=\"dark\"]","wordLimit":0,"pageSize":10},
          {
            el: '#waline',
            path: window.location.pathname
          }
        )
        Waline.init(options);
        Fluid.utils.waitElementVisible('#waline .vcontent', () => {
          var imgSelector = '#waline .vcontent img:not(.vemoji)';
          Fluid.plugins.imageCaption(imgSelector);
          Fluid.plugins.fancyBox(imgSelector);
        })
      });
    });
  </script>
  <noscript>Please enable JavaScript to view the comments</noscript>


  </article>


          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="margin-left: -1rem">
    <div id="toc">
  <p class="toc-header"><i class="iconfont icon-list"></i>&nbsp;目录</p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>
  </div>
</div>





  



  



  



  



  







    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
     
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">搜索</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">关键词</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
      <div class="col-lg-7 mx-auto nopadding-x-md">
        <div class="container custom mx-auto">
          <div id="waline"></div> <script> const locale = { placeholder: "说点什么吧！(填写邮箱可在被回复时收到邮件提醒)", }; Waline.init({ el: "#waline", serverURL: "https://comment.zhouyinglin.cn/", locale, }); </script>
        </div>
      </div>
    
  </main>

  <footer>
    <div class="footer-inner">
  
    <div class="footer-content">
       <link rel="stylesheet" href="/dist/APlayer.min.css"> <div id="aplayer"></div> <script type="text/javascript" src="/dist/APlayer.min.js"></script> <script type="text/javascript" src="/js/amusic.js"></script>  <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> <div class="statistics" style="font-size: 0.85rem"> <a target="_blank" rel="noopener" href="https://developer.hitokoto.cn/" id="hitokoto_text"><span style="color: #3c4858;"  id="hitokoto"></span></a> <script src="https://v1.hitokoto.cn/?encode=js&select=%23hitokoto" defer></script></div>  <div style="font-size: 0.85rem"> <span id="timeDate">载入天数...</span> <span id="times">载入时分秒...</span> <script src="/js/duration.js"></script> </div>
    </div>
  
  
    <div class="statistics">
  
  

  
    
      <span id="leancloud-site-pv-container" style="display: none">
        总访客量 
        <span id="leancloud-site-pv"></span>
         次 
      </span>
    
    
      <span id="leancloud-site-uv-container" style="display: none">
        总用户量 
        <span id="leancloud-site-uv"></span>
         人
      </span>
    
    

  
</div>
<div class="statistics">
 	<a target="_blank" rel="noopener" href="https://developer.hitokoto.cn/" id="hitokoto_text"><span style="color: #DDD;"  id="hitokoto"></span></a>
<script src="https://v1.hitokoto.cn/?encode=js&select=%23hitokoto" defer></script>
 </div>

  
  
  
</div>

  </footer>

  <!-- Scripts -->
  
  <script  src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://lib.baomitu.com/jquery/3.6.0/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>


  <script  src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var subtitle = document.getElementById('subtitle');
      if (!subtitle || !typing) {
        return;
      }
      var text = subtitle.getAttribute('data-typed-text');
      
        typing(text);
      
    })(window, document);
  </script>




  
    <script  src="/js/img-lazyload.js" ></script>
  




  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/tocbot/4.18.2/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      headingSelector : CONFIG.toc.headingSelector || 'h1,h2,h3,h4,h5,h6',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      collapseDepth   : CONFIG.toc.collapseDepth || 0,
      scrollSmooth    : true,
      headingsOffset  : -boardTop
    });
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }
  });
</script>


  <script src=https://lib.baomitu.com/clipboard.js/2.0.10/clipboard.min.js></script>

  <script>Fluid.plugins.codeWidget();</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/4.3.1/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));
  });
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  <script>Fluid.plugins.imageCaption();</script>

  <script defer src="/js/leancloud.js" ></script>

  <script  src="/js/local-search.js" ></script>




  
<script src="https://unpkg.com/@waline/client@v2/dist/waline.js"></script>



<!-- 主题的启动项，将它保持在最底部 -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="/js/boot.js" ></script>


  

  <noscript>
    <div class="noscript-warning">博客在允许 JavaScript 运行的环境下浏览效果更佳</div>
  </noscript>
</body>
</html>
